{"version":3,"file":"Suggestions.js","sourceRoot":"../src/","sources":["components/pickers/Suggestions/Suggestions.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  BaseComponent,\n  css,\n  autobind,\n  assign,\n  KeyCodes\n} from '../../../Utilities';\nimport { CommandButton, IconButton, IButton } from '../../../Button';\nimport { Spinner } from '../../../Spinner';\nimport { ISuggestionItemProps, ISuggestionsProps } from './Suggestions.Props';\nimport * as stylesImport from './Suggestions.scss';\nconst styles: any = stylesImport;\n\nexport class SuggestionsItem<T> extends BaseComponent<ISuggestionItemProps<T>, {}> {\n  public render() {\n    let {\n      suggestionModel,\n      RenderSuggestion,\n      onClick,\n      className,\n      onRemoveItem,\n      showRemoveButton,\n      id\n    } = this.props;\n    let itemProps = assign({}, suggestionModel.item, { onRemoveItem });\n    return (\n      <div\n        className={ css(\n          'ms-Suggestions-item',\n          styles.suggestionsItem,\n          {\n            ['is-suggested ' + styles.suggestionsItemIsSuggested]: suggestionModel.selected\n          },\n          className\n        ) }\n      >\n        <CommandButton\n          onClick={ onClick }\n          className={ css('ms-Suggestions-itemButton', styles.itemButton) }\n        >\n          { RenderSuggestion(suggestionModel.item, this.props) }\n        </CommandButton>\n        { this.props.showRemoveButton ? (\n          <IconButton\n            iconProps={ { iconName: 'Cancel', style: { fontSize: '12px' } } }\n            title='Remove'\n            ariaLabel='Remove'\n            onClick={ onRemoveItem }\n            className={ css('ms-Suggestions-closeButton', styles.closeButton) }\n          />) : (null)\n        }\n      </div>\n    );\n  }\n}\n\nexport class Suggestions<T> extends BaseComponent<ISuggestionsProps<T>, {}> {\n\n  protected _searchForMoreButton: IButton;\n  protected _selectedElement: HTMLDivElement;\n  private SuggestionsItemOfProperType = SuggestionsItem as new (props: ISuggestionItemProps<T>) => SuggestionsItem<T>;\n\n  constructor(suggestionsProps: ISuggestionsProps<T>) {\n    super(suggestionsProps);\n  }\n\n  public componentDidUpdate() {\n    this.scrollSelected();\n  }\n\n  public render() {\n    let {\n      suggestionsHeaderText,\n      mostRecentlyUsedHeaderText,\n      searchForMoreText,\n      className,\n      moreSuggestionsAvailable,\n      noResultsFoundText,\n      suggestions,\n      isLoading,\n      isSearching,\n      loadingText,\n      onRenderNoResultFound,\n      searchingText,\n      isMostRecentlyUsedVisible,\n      resultsMaximumNumber,\n      resultsFooterFull,\n      resultsFooter,\n      isResultsFooterVisible,\n      showRemoveButtons,\n      suggestionsAvailableAlertText\n    } = this.props;\n\n    let noResults = () => {\n      return noResultsFoundText ?\n        <div role='alert' className={ css('ms-Suggestions-none', styles.suggestionsNone) }>\n          { noResultsFoundText }\n        </div> : null;\n    };\n\n    let headerText = isMostRecentlyUsedVisible && mostRecentlyUsedHeaderText ? mostRecentlyUsedHeaderText : null;\n    let footerTitle = (suggestions.length >= (resultsMaximumNumber as number)) ? resultsFooterFull : resultsFooter;\n    return (\n      <div className={ css(\n        'ms-Suggestions',\n        className ? className : '',\n        styles.root) }>\n        { headerText ?\n          (<div className={ css('ms-Suggestions-title', styles.suggestionsTitle) }>\n            { headerText }\n          </div>) : (null) }\n        { isLoading && (\n          <Spinner\n            className={ css('ms-Suggestions-spinner', styles.suggestionsSpinner) }\n            label={ loadingText }\n          />) }\n        { (!suggestions || !suggestions.length) && !isLoading ?\n          (onRenderNoResultFound ? onRenderNoResultFound(undefined, noResults) : noResults()) :\n          this._renderSuggestions()\n        }\n        { searchForMoreText && moreSuggestionsAvailable && (\n          <CommandButton\n            componentRef={ this._resolveRef('_searchForMoreButton') }\n            className={ css('ms-SearchMore-button', styles.searchMoreButton) }\n            iconProps={ { iconName: 'Search' } }\n            onClick={ this._getMoreResults }\n            onKeyDown={ this._onKeyDown }\n          >\n            { searchForMoreText }\n          </CommandButton>\n        ) }\n        { isSearching ?\n          (<Spinner\n            className={ css('ms-Suggestions-spinner', styles.suggestionsSpinner) }\n            label={ searchingText }\n          />) : (null)\n        }\n        {\n          !moreSuggestionsAvailable && !isMostRecentlyUsedVisible && !isSearching ?\n            (<div className={ css('ms-Suggestions-title', styles.suggestionsTitle) }>\n              { footerTitle && footerTitle(this.props) }\n            </div>) : (null)\n        }\n        { (!isLoading && !isSearching && suggestions && suggestions.length > 0 && suggestionsAvailableAlertText) ?\n          (<span\n            role='alert'\n            className={ css('ms-Suggestions-suggestionsAvailable', styles.suggestionsAvailable) }>{ suggestionsAvailableAlertText }\n          </span>) : (null)\n        }\n      </div>\n    );\n  }\n\n  public focusSearchForMoreButton() {\n    if (this._searchForMoreButton) {\n      this._searchForMoreButton.focus();\n    }\n  }\n\n  // TODO get the element to scroll into view properly regardless of direction.\n  public scrollSelected() {\n    if (this._selectedElement) {\n      this._selectedElement.scrollIntoView(false);\n    }\n  }\n\n  private _renderSuggestions(): JSX.Element {\n    let {\n      suggestions,\n      onRenderSuggestion,\n      suggestionsItemClassName,\n      resultsMaximumNumber,\n      showRemoveButtons } = this.props;\n    let TypedSuggestionsItem = this.SuggestionsItemOfProperType;\n\n    if (resultsMaximumNumber) {\n      suggestions = suggestions.slice(0, resultsMaximumNumber);\n    }\n\n    return (\n      <div\n        className={ css('ms-Suggestions-container', styles.suggestionsContainer) }\n        id='suggestion-list'\n        role='menu'>\n        { suggestions.map((suggestion, index) =>\n          <div ref={ this._resolveRef(suggestion.selected ? '_selectedElement' : '') }\n            // tslint:disable-next-line:no-string-literal\n            key={ (suggestion.item as any)['key'] ? (suggestion.item as any)['key'] : index }\n            id={ 'sug-' + index }\n            role='menuitem'>\n            <TypedSuggestionsItem\n              id={ 'sug-item' + index }\n              suggestionModel={ suggestion }\n              RenderSuggestion={ onRenderSuggestion as any }\n              onClick={ (ev: React.MouseEvent<HTMLElement>) => { this.props.onSuggestionClick(ev, suggestion.item, index); } }\n              className={ suggestionsItemClassName }\n              showRemoveButton={ showRemoveButtons }\n              onRemoveItem={ (ev: React.MouseEvent<HTMLElement>) => {\n                let onSuggestionRemove = this.props.onSuggestionRemove!;\n                onSuggestionRemove(ev, suggestion.item, index);\n                ev.stopPropagation();\n              }\n              }\n            />\n          </div>) }\n      </div>);\n  }\n\n  @autobind\n  private _getMoreResults() {\n    if (this.props.onGetMoreResults) {\n      this.props.onGetMoreResults();\n    }\n  }\n\n  @autobind\n  private _onKeyDown(ev: React.KeyboardEvent<HTMLButtonElement>) {\n    if ((ev.keyCode === KeyCodes.up || ev.keyCode === KeyCodes.down) && typeof this.props.refocusSuggestions === 'function') {\n      this.props.refocusSuggestions(ev.keyCode);\n    }\n  }\n}"]}