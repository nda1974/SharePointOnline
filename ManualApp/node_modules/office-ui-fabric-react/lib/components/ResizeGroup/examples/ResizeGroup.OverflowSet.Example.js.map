{"version":3,"file":"ResizeGroup.OverflowSet.Example.js","sourceRoot":"../src/","sources":["components/ResizeGroup/examples/ResizeGroup.OverflowSet.Example.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport { BaseComponent, autobind } from 'office-ui-fabric-react/lib/Utilities';\nimport { DefaultButton, PrimaryButton } from 'office-ui-fabric-react/lib/Button';\nimport { ResizeGroup } from 'office-ui-fabric-react/lib/ResizeGroup';\nimport { OverflowSet } from '../../OverflowSet';\nimport { Checkbox } from 'office-ui-fabric-react/lib/Checkbox';\nimport { IContextualMenuItem } from 'office-ui-fabric-react/lib/ContextualMenu';\nimport { Dropdown, IDropdownOption } from 'office-ui-fabric-react/lib/Dropdown';\n\nimport * as stylesImport from './ResizeGroup.Example.scss';\nconst styles: any = stylesImport;\n\nexport interface IOverflowData {\n  primary: IContextualMenuItem[];\n  overflow: IContextualMenuItem[];\n  cacheKey?: string;\n}\n\nfunction generateData(count: number, cachingEnabled: boolean, checked: boolean): IOverflowData {\n  const icons = ['Add', 'Share', 'Upload'];\n  let dataItems = [];\n  let cacheKey = '';\n  for (let index = 0; index < count; index++) {\n    let item = {\n      key: `item${index}`,\n      name: `Item ${index}`,\n      icon: icons[index % icons.length],\n      checked: checked\n    };\n\n    cacheKey = cacheKey + item.key;\n    dataItems.push(item);\n  }\n\n  let result: IOverflowData = {\n    primary: dataItems,\n    overflow: [] as any[]\n  };\n\n  if (cachingEnabled) {\n    result = { ...result, cacheKey };\n  }\n\n  return result;\n}\n\nexport interface IResizeGroupOverflowSetExampleState {\n  short: boolean;\n  numberOfItems: number;\n  buttonsChecked: boolean;\n  cachingEnabled: boolean;\n  onGrowDataEnabled: boolean;\n}\n\nfunction computeCacheKey(primaryControls: IContextualMenuItem[]): string {\n  return primaryControls.reduce((acc, current) => acc + current.key, '');\n}\n\nexport class ResizeGroupOverflowSetExample extends BaseComponent<{}, IResizeGroupOverflowSetExampleState> {\n\n  constructor(props: {}) {\n    super(props);\n    this.state = {\n      short: false,\n      buttonsChecked: false,\n      cachingEnabled: false,\n      onGrowDataEnabled: false,\n      numberOfItems: 20\n    };\n  }\n\n  public render() {\n    let { numberOfItems, cachingEnabled, buttonsChecked, short, onGrowDataEnabled } = this.state;\n    let dataToRender = generateData(numberOfItems, cachingEnabled, buttonsChecked);\n    return (\n      <div className={ short ? styles.resizeIsShort : 'notResized' }>\n        <ResizeGroup\n          data={ dataToRender }\n          onReduceData={ this._onReduceData }\n          onGrowData={ onGrowDataEnabled ? this._onGrowData : undefined }\n          onRenderData={ (data) => {\n            return (\n              <OverflowSet\n                items={ data.primary }\n                overflowItems={ data.overflow.length ? data.overflow : null }\n                onRenderItem={ (item) => {\n                  return (\n                    <DefaultButton\n                      text={ item.name }\n                      iconProps={ { iconName: item.icon } }\n                      onClick={ item.onClick }\n                      checked={ item.checked }\n                    />\n                  );\n                } }\n                onRenderOverflowButton={ (overflowItems) => {\n                  return (\n                    <DefaultButton\n                      menuProps={ { items: overflowItems! } }\n                    />\n                  );\n                } }\n              />\n            );\n          } }\n        />\n        <div className={ styles.settingsGroup }>\n          <Checkbox label='Enable caching' onChange={ this._onCachingEnabledChanged } checked={ cachingEnabled } />\n          <Checkbox label='Set onGrowData' onChange={ this._onGrowDataEnabledChanged } checked={ onGrowDataEnabled } />\n          <Checkbox label='Buttons checked' onChange={ this._onButtonsCheckedChanged } checked={ buttonsChecked } />\n          <div className={ styles.itemCountDropdown } >\n            <Dropdown\n              label='Number of items to render'\n              selectedKey={ numberOfItems.toString() }\n              onChanged={ this._onNumberOfItemsChanged }\n              options={\n                [{ key: '20', text: '20' },\n                { key: '30', text: '30' },\n                { key: '40', text: '40' },\n                { key: '50', text: '50' },\n                { key: '75', text: '75' },\n                { key: '100', text: '100' },\n                { key: '200', text: '200' }] } />\n          </div>\n        </div>\n      </div>\n    );\n  }\n\n  @autobind\n  private _onReduceData(currentData: any): any {\n    if (currentData.primary.length === 0) {\n      return undefined;\n    }\n\n    let overflow = [...currentData.primary.slice(-1), ...currentData.overflow];\n    let primary = currentData.primary.slice(0, -1);\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  }\n\n  @autobind\n  private _onGrowData(currentData: any): any {\n    if (currentData.overflow.length === 0) {\n      return undefined;\n    }\n\n    let overflow = currentData.overflow.slice(1);\n    let primary = [...currentData.primary, ...currentData.overflow.slice(0, 1)];\n\n    let cacheKey = undefined;\n    if (this.state.cachingEnabled) {\n      cacheKey = computeCacheKey(primary);\n    }\n    return { primary, overflow, cacheKey };\n  }\n\n  @autobind\n  private _onCachingEnabledChanged(_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean) {\n    this.setState({ cachingEnabled: checked });\n  }\n\n  @autobind\n  private _onGrowDataEnabledChanged(_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean) {\n    this.setState({ onGrowDataEnabled: checked });\n  }\n\n  @autobind\n  private _onButtonsCheckedChanged(_: React.FormEvent<HTMLElement | HTMLInputElement>, checked: boolean) {\n    this.setState({ buttonsChecked: checked });\n  }\n\n  @autobind\n  private _onNumberOfItemsChanged(option: IDropdownOption) {\n    this.setState({ numberOfItems: parseInt(option.text, 10) });\n  }\n}"]}