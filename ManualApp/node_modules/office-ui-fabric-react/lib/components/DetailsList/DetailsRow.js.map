{"version":3,"file":"DetailsRow.js","sourceRoot":"../src/","sources":["components/DetailsList/DetailsRow.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport * as ReactDOM from 'react-dom';\nimport {\n  BaseComponent,\n  IDisposable,\n  assign,\n  autobind,\n  css,\n  shallowCompare,\n  getNativeProps,\n  divProperties\n} from '../../Utilities';\nimport { IColumn, CheckboxVisibility } from './DetailsList.Props';\nimport { DetailsRowCheck, IDetailsRowCheckProps } from './DetailsRowCheck';\nimport { GroupSpacer } from '../GroupedList/GroupSpacer';\nimport { DetailsRowFields } from './DetailsRowFields';\nimport { FocusZone, FocusZoneDirection, IFocusZone } from '../../FocusZone';\nimport { ISelection, SelectionMode, SELECTION_CHANGE } from '../../utilities/selection/interfaces';\nimport { CollapseAllVisibility } from '../../GroupedList';\nimport {\n  IDragDropHelper,\n  IDragDropEvents,\n  IDragDropOptions,\n} from './../../utilities/dragdrop/interfaces';\nimport { IViewport } from '../../utilities/decorators/withViewport';\nimport * as stylesImport from './DetailsRow.scss';\nconst styles: any = stylesImport;\nimport { AnimationClassNames } from '../../Styling';\nimport * as checkStyles from './DetailsRowCheck.scss';\n\nexport interface IDetailsRowProps extends React.Props<DetailsRow> {\n  componentRef?: () => void;\n  item: any;\n  itemIndex: number;\n  columns: IColumn[];\n  compact?: boolean;\n  selectionMode: SelectionMode;\n  selection: ISelection;\n  eventsToRegister?: { eventName: string, callback: (item?: any, index?: number, event?: any) => void }[];\n  onDidMount?: (row?: DetailsRow) => void;\n  onWillUnmount?: (row?: DetailsRow) => void;\n  onRenderCheck?: (props: IDetailsRowCheckProps) => JSX.Element;\n  onRenderItemColumn?: (item?: any, index?: number, column?: IColumn) => any;\n  dragDropEvents?: IDragDropEvents;\n  dragDropHelper?: IDragDropHelper;\n  groupNestingDepth?: number;\n  viewport?: IViewport;\n  checkboxVisibility?: CheckboxVisibility;\n  collapseAllVisibility?: CollapseAllVisibility;\n  getRowAriaLabel?: (item: any) => string;\n  checkButtonAriaLabel?: string;\n}\n\nexport interface IDetailsRowSelectionState {\n  isSelected: boolean;\n  anySelected: boolean;\n}\n\nexport interface IDetailsRowState {\n  selectionState?: IDetailsRowSelectionState;\n  columnMeasureInfo?: {\n    index: number;\n    column: IColumn;\n    onMeasureDone: (measuredWidth: number) => void;\n  };\n  isDropping?: boolean;\n  groupNestingDepth?: number;\n}\n\nconst DEFAULT_DROPPING_CSS_CLASS = 'is-dropping';\n\nexport class DetailsRow extends BaseComponent<IDetailsRowProps, IDetailsRowState> {\n  public refs: {\n    [key: string]: React.ReactInstance,\n    cellMeasurer: HTMLElement\n  };\n\n  private _root: HTMLElement | undefined;\n  private _focusZone: IFocusZone;\n  private _hasSetFocus: boolean;\n  private _droppingClassNames: string;\n  private _hasMounted: boolean;\n  private _dragDropSubscription: IDisposable;\n\n  constructor(props: IDetailsRowProps) {\n    super(props);\n\n    this.state = {\n      selectionState: this._getSelectionState(props),\n      columnMeasureInfo: undefined,\n      isDropping: false,\n      groupNestingDepth: props.groupNestingDepth\n    };\n\n    this._hasSetFocus = false;\n\n    this._droppingClassNames = '';\n\n    this._updateDroppingState = this._updateDroppingState.bind(this);\n    this._onToggleSelection = this._onToggleSelection.bind(this);\n  }\n\n  public componentDidMount() {\n    let { dragDropHelper } = this.props;\n\n    if (dragDropHelper) {\n      this._dragDropSubscription = dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\n    }\n\n    this._events.on(this.props.selection, SELECTION_CHANGE, this._onSelectionChanged);\n\n    if (this.props.onDidMount && this.props.item) {\n      // If the item appears later, we should wait for it before calling this method.\n      this._hasMounted = true;\n      this.props.onDidMount(this);\n    }\n  }\n\n  public componentDidUpdate(previousProps: IDetailsRowProps) {\n    let state = this.state;\n    let { item, onDidMount } = this.props;\n    let { columnMeasureInfo } = state;\n\n    if (this.props.itemIndex !== previousProps.itemIndex ||\n      this.props.item !== previousProps.item ||\n      this.props.dragDropHelper !== previousProps.dragDropHelper) {\n      if (this._dragDropSubscription) {\n        this._dragDropSubscription.dispose();\n        delete this._dragDropSubscription;\n      }\n\n      if (this.props.dragDropHelper) {\n        this._dragDropSubscription = this.props.dragDropHelper.subscribe(this._root as HTMLElement, this._events, this._getRowDragDropOptions());\n      }\n    }\n\n    if (columnMeasureInfo && columnMeasureInfo.index >= 0) {\n      let newWidth = this.refs.cellMeasurer.getBoundingClientRect().width;\n\n      columnMeasureInfo.onMeasureDone(newWidth);\n\n      this.setState({\n        columnMeasureInfo: undefined\n      });\n    }\n\n    if (item && onDidMount && !this._hasMounted) {\n      this._hasMounted = true;\n      onDidMount(this);\n    }\n  }\n\n  public componentWillUnmount() {\n    let { item, onWillUnmount } = this.props;\n\n    // Only call the onWillUnmount callback if we have an item.\n    if (onWillUnmount && item) {\n      onWillUnmount(this);\n    }\n\n    if (this._dragDropSubscription) {\n      this._dragDropSubscription.dispose();\n      delete this._dragDropSubscription;\n    }\n  }\n\n  public componentWillReceiveProps(newProps: IDetailsRowProps) {\n    this.setState({\n      selectionState: this._getSelectionState(newProps),\n      groupNestingDepth: newProps.groupNestingDepth\n    });\n  }\n\n  public render() {\n    const {\n      columns,\n      dragDropEvents,\n      item,\n      itemIndex,\n      onRenderCheck = this._onRenderCheck,\n      onRenderItemColumn,\n      selectionMode,\n      viewport,\n      checkboxVisibility,\n      getRowAriaLabel,\n      checkButtonAriaLabel,\n      selection\n    } = this.props;\n    const { columnMeasureInfo, isDropping, groupNestingDepth } = this.state;\n    const { isSelected, anySelected } = this.state.selectionState as IDetailsRowSelectionState;\n    const isDraggable = Boolean(dragDropEvents && dragDropEvents.canDrag && dragDropEvents.canDrag(item));\n    const droppingClassName = isDropping ? (this._droppingClassNames ? this._droppingClassNames : DEFAULT_DROPPING_CSS_CLASS) : '';\n    const ariaLabel = getRowAriaLabel ? getRowAriaLabel(item) : null;\n    const canSelect = selection.canSelectItem!(item);\n    const isContentUnselectable = selectionMode === SelectionMode.multiple;\n    const showCheckbox = selectionMode !== SelectionMode.none && checkboxVisibility !== CheckboxVisibility.hidden;\n\n    return (\n      <FocusZone\n        {...getNativeProps(this.props, divProperties) }\n        direction={ FocusZoneDirection.horizontal }\n        ref={ this._onRootRef }\n        componentRef={ this._resolveRef('_focusZone') }\n        role='row'\n        aria-label={ ariaLabel }\n        className={ css(\n          'ms-DetailsRow',\n          AnimationClassNames.fadeIn400,\n          styles.root,\n          checkStyles.owner,\n          droppingClassName,\n          {\n            [`is-contentUnselectable ${styles.rootIsContentUnselectable}`]: isContentUnselectable,\n            [`is-selected ${checkStyles.isSelected} ${styles.rootIsSelected}`]: isSelected,\n            [`is-check-visible ${checkStyles.isVisible}`]: checkboxVisibility === CheckboxVisibility.always\n          }) }\n        data-is-focusable={ true }\n        data-selection-index={ itemIndex }\n        data-item-index={ itemIndex }\n        aria-rowindex={ itemIndex }\n        data-is-draggable={ isDraggable }\n        draggable={ isDraggable }\n        data-automationid='DetailsRow'\n        style={ { minWidth: viewport ? viewport.width : 0 } }\n        aria-selected={ isSelected }\n        allowFocusRoot={ true }\n      >\n        { showCheckbox && (\n          <div\n            role='gridcell'\n            aria-colindex={ 0 }\n            data-selection-toggle={ true }\n            className={ css('ms-DetailsRow-cell', 'ms-DetailsRow-cellCheck', checkStyles.owner, styles.cell, styles.checkCell) }\n          >\n            { onRenderCheck({\n              isSelected,\n              anySelected,\n              title: checkButtonAriaLabel,\n              canSelect\n            }) }\n          </div>\n        ) }\n\n        { GroupSpacer({ count: groupNestingDepth! - (this.props.collapseAllVisibility === CollapseAllVisibility.hidden ? 1 : 0) }) }\n\n        { item && (\n          <DetailsRowFields\n            columns={ columns }\n            item={ item }\n            itemIndex={ itemIndex }\n            columnStartIndex={ showCheckbox ? 1 : 0 }\n            onRenderItemColumn={ onRenderItemColumn } />\n        ) }\n\n        { columnMeasureInfo && (\n          <span\n            role='presentation'\n            className={ css('ms-DetailsRow-cellMeasurer ms-DetailsRow-cell', styles.cellMeasurer, styles.cell) }\n            ref='cellMeasurer'\n          >\n            <DetailsRowFields\n              columns={ [columnMeasureInfo.column] }\n              item={ item }\n              itemIndex={ itemIndex }\n              columnStartIndex={ (showCheckbox ? 1 : 0) + columns.length }\n              onRenderItemColumn={ onRenderItemColumn } />\n          </span>\n        ) }\n      </FocusZone>\n    );\n  }\n\n  /**\n   * measure cell at index. and call the call back with the measured cell width when finish measure\n   *\n   * @param {number} index (the cell index)\n   * @param {(width: number) => void} onMeasureDone (the call back function when finish measure)\n   */\n  public measureCell(index: number, onMeasureDone: (width: number) => void) {\n    let column = assign({}, this.props.columns[index]) as IColumn;\n\n    column.minWidth = 0;\n    column.maxWidth = 999999;\n\n    delete column.calculatedWidth;\n\n    this.setState({\n      columnMeasureInfo: {\n        index,\n        column,\n        onMeasureDone\n      }\n    });\n  }\n\n  public focus(): boolean {\n    return !!this._focusZone && this._focusZone.focus();\n  }\n\n  protected _onRenderCheck(props: IDetailsRowCheckProps) {\n    return <DetailsRowCheck { ...props } />;\n  }\n\n  private _getSelectionState(props: IDetailsRowProps): IDetailsRowSelectionState {\n    let { itemIndex, selection } = props;\n\n    return {\n      isSelected: selection.isIndexSelected(itemIndex),\n      anySelected: selection.getSelectedCount() > 0\n    };\n  }\n\n  private _onSelectionChanged() {\n    let selectionState = this._getSelectionState(this.props);\n\n    if (!shallowCompare(selectionState, this.state.selectionState)) {\n      this.setState({\n        selectionState: selectionState\n      });\n    }\n  }\n\n  private _onToggleSelection() {\n    const { selection } = this.props;\n\n    selection.toggleIndexSelected(this.props.itemIndex);\n  }\n\n  @autobind\n  private _onRootRef(focusZone: FocusZone) {\n    if (focusZone) {\n      // Need to resolve the actual DOM node, not the component. The element itself will be used for drag/drop and focusing.\n      this._root = ReactDOM.findDOMNode(focusZone) as HTMLElement;\n    } else {\n      this._root = undefined;\n    }\n  }\n\n  private _getRowDragDropOptions(): IDragDropOptions {\n    const {\n      item,\n      itemIndex,\n      dragDropEvents,\n      eventsToRegister\n    } = this.props;\n    let options = {\n      eventMap: eventsToRegister,\n      selectionIndex: itemIndex,\n      context: { data: item, index: itemIndex },\n      canDrag: dragDropEvents!.canDrag,\n      canDrop: dragDropEvents!.canDrop,\n      onDragStart: dragDropEvents!.onDragStart,\n      updateDropState: this._updateDroppingState,\n      onDrop: dragDropEvents!.onDrop,\n      onDragEnd: dragDropEvents!.onDragEnd,\n    };\n\n    return options;\n  }\n\n  /**\n   * update isDropping state based on the input value, which is used to change style during drag and drop\n   *\n   * when change to true, that means drag enter. we will add default dropping class name\n   * or the custom dropping class name (return result from onDragEnter) to the root elemet.\n   *\n   * when change to false, that means drag leave. we will remove the dropping class name from root element.\n   *\n   * @private\n   * @param {boolean} newValue (new isDropping state value)\n   * @param {DragEvent} event (the event trigger dropping state change which can be dragenter, dragleave etc)\n   */\n  private _updateDroppingState(newValue: boolean, event: DragEvent) {\n    let { selectionState, isDropping } = this.state;\n    let { dragDropEvents, item } = this.props;\n\n    if (!newValue) {\n      if (dragDropEvents!.onDragLeave) {\n        dragDropEvents!.onDragLeave!(item, event);\n      }\n    } else {\n      if (dragDropEvents!.onDragEnter) {\n        this._droppingClassNames = dragDropEvents!.onDragEnter!(item, event);\n      }\n    }\n\n    if (isDropping !== newValue) {\n      this.setState({ selectionState: selectionState, isDropping: newValue });\n    }\n  }\n}\n"]}