{"version":3,"file":"GroupHeader.js","sourceRoot":"../src/","sources":["components/GroupedList/GroupHeader.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  BaseComponent,\n  autobind,\n  css\n} from '../../Utilities';\nimport { IGroupDividerProps } from './GroupedList.Props';\nimport { SelectionMode } from '../../utilities/selection/index';\nimport { Check } from '../../Check';\nimport { Icon } from '../../Icon';\nimport { GroupSpacer } from './GroupSpacer';\nimport { Spinner } from '../../Spinner';\nimport { FocusZone, FocusZoneDirection } from '../../FocusZone';\nimport * as stylesImport from './GroupHeader.scss';\nconst styles: any = stylesImport;\n\nexport interface IGroupHeaderState {\n  isCollapsed: boolean;\n  isLoadingVisible: boolean;\n}\n\nexport class GroupHeader extends BaseComponent<IGroupDividerProps, IGroupHeaderState> {\n  constructor(props: IGroupDividerProps) {\n    super(props);\n\n    this.state = {\n      isCollapsed: (this.props.group && this.props.group.isCollapsed) as boolean,\n      isLoadingVisible: false\n    };\n  }\n\n  public componentWillReceiveProps(newProps: any) {\n    if (newProps.group) {\n      let newCollapsed = newProps.group.isCollapsed;\n      let isGroupLoading = newProps.headerProps && newProps.headerProps.isGroupLoading;\n      let newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(newProps.group);\n\n      this.setState({\n        isCollapsed: newCollapsed,\n        isLoadingVisible: newLoadingVisible\n      });\n    }\n  }\n\n  public render(): JSX.Element | null {\n    let {\n      group,\n      groupLevel,\n      viewport,\n      selectionMode,\n      loadingText,\n      isSelected,\n      selected,\n      isCollapsedGroupSelectVisible\n    } = this.props;\n    let { isCollapsed, isLoadingVisible } = this.state;\n\n    if (isCollapsedGroupSelectVisible === undefined) {\n      isCollapsedGroupSelectVisible = true;\n    }\n    let canSelectGroup = selectionMode === SelectionMode.multiple;\n    let isSelectionCheckVisible = canSelectGroup && (isCollapsedGroupSelectVisible || !(group && group.isCollapsed));\n    let currentlySelected = isSelected || selected;\n\n    if (!group) {\n      return null;\n    }\n    return (\n      <div\n        className={ css('ms-GroupHeader', styles.root, {\n          ['is-selected ' + styles.rootIsSelected]: currentlySelected\n        }) }\n        style={ viewport ? { minWidth: viewport.width } : {} }\n        onClick={ this._onHeaderClick }\n        aria-label={ group.ariaLabel || group.name }\n        data-is-focusable={ true } >\n\n        <FocusZone className={ styles.groupHeaderContainer } direction={ FocusZoneDirection.horizontal }>\n\n          { isSelectionCheckVisible ? (\n            <button\n              type='button'\n              className={ css('ms-GroupHeader-check', styles.check) }\n              data-selection-toggle={ true }\n              onClick={ this._onToggleSelectGroupClick } >\n              <Check checked={ currentlySelected } />\n            </button>\n          ) : (selectionMode !== SelectionMode.none ? GroupSpacer({ count: 1 }) : null)\n          }\n\n          { GroupSpacer({ count: groupLevel as number }) }\n\n          <div className={ css('ms-GroupHeader-dropIcon', styles.dropIcon) }>\n            <Icon iconName='Tag' />\n          </div>\n          <button\n            type='button'\n            className={ css('ms-GroupHeader-expand', styles.expand) }\n            onClick={ this._onToggleCollapse }>\n            <Icon\n              className={ css(\n                isCollapsed && ('is-collapsed ' + styles.expandIsCollapsed)\n              ) }\n              iconName='ChevronDown'\n            />\n          </button>\n\n          <div className={ css('ms-GroupHeader-title', styles.title) }>\n            <span>{ group.name }</span>\n            {\n              // hasMoreData flag is set when grouping is throttle by SPO server which in turn resorts to regular\n              // sorting to simulate grouping behaviors, in which case group count is the number of items returned\n              // so far. That's the reasons we need to use \"+\" to show we might have more items than count\n              // indicates.\n            }\n            <span className={ styles.headerCount }>({ group.count }{ group.hasMoreData && '+' })</span>\n          </div>\n\n          <div\n            className={ css(\n              'ms-GroupHeader-loading',\n              styles.loading,\n              isLoadingVisible && ('is-loading ' + styles.loadingIsVisible)\n            ) }\n          >\n            <Spinner label={ loadingText } />\n          </div>\n\n        </FocusZone>\n      </div>\n    );\n  }\n\n  @autobind\n  private _onToggleCollapse(ev: React.MouseEvent<HTMLElement>) {\n    let { group, onToggleCollapse, isGroupLoading } = this.props;\n    let { isCollapsed } = this.state;\n\n    let newCollapsed = !isCollapsed;\n    let newLoadingVisible = !newCollapsed && isGroupLoading && isGroupLoading(group!);\n\n    this.setState({\n      isCollapsed: newCollapsed,\n      isLoadingVisible: newLoadingVisible as boolean\n    });\n    if (onToggleCollapse) {\n      onToggleCollapse(group!);\n    }\n\n    ev.stopPropagation();\n    ev.preventDefault();\n  }\n\n  @autobind\n  private _onToggleSelectGroupClick(ev: React.MouseEvent<HTMLElement>) {\n    let { onToggleSelectGroup, group } = this.props;\n\n    if (onToggleSelectGroup) {\n      onToggleSelectGroup(group!);\n    }\n\n    ev.preventDefault();\n    ev.stopPropagation();\n  }\n\n  @autobind\n  private _onHeaderClick() {\n    let { group, onGroupHeaderClick, onToggleSelectGroup } = this.props;\n\n    if (onGroupHeaderClick) {\n      onGroupHeaderClick(group!);\n    } else if (onToggleSelectGroup) {\n      onToggleSelectGroup(group!);\n    }\n  }\n}\n"]}