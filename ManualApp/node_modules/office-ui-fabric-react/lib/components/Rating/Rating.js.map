{"version":3,"file":"Rating.js","sourceRoot":"../src/","sources":["components/Rating/Rating.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  BaseComponent,\n  css,\n  getId\n} from '../../Utilities';\nimport { Icon } from '../../Icon';\nimport { IRatingProps, RatingSize } from './Rating.Props';\nimport * as stylesImport from './Rating.scss';\nconst styles: any = stylesImport;\n\nexport interface IRatingState {\n  rating: number | null | undefined;\n  focusedRating: number | null;\n}\n\nexport class Rating extends BaseComponent<IRatingProps, IRatingState> {\n  public static defaultProps: IRatingProps = {\n    min: 1,\n    max: 5\n  };\n\n  private _id: string;\n  private _labelId: string;\n\n  constructor(props: IRatingProps) {\n    super(props);\n\n    this.state = {\n      rating: this._getInitialValue(props),\n      focusedRating: null\n    };\n\n    this._id = getId('Rating');\n    this._labelId = getId('RatingLabel');\n  }\n\n  public componentWillReceiveProps(nextProps: IRatingProps) {\n    if (typeof nextProps.rating !== 'undefined' && nextProps.rating !== this.state.rating) {\n      this.setState({\n        rating: this._getClampedRating(nextProps.rating)\n      } as IRatingState);\n    }\n  }\n\n  public render() {\n    let stars: JSX.Element[] = [];\n    for (let i = this.props.min as number; i <= (this.props.max as number); ++i) {\n      stars.push(this._renderStar(i));\n    }\n\n    return <div className={ css('ms-Rating', this.props.className, {\n      ['ms-Rating--large ' + styles.rootIsLarge]: this.props.size === RatingSize.Large\n    }) } role='application'>\n      <div className={ css('ms-Rating-container', styles.container) } role='radiogroup' aria-labelledby={ this.props.ariaLabelId }>\n        { stars }\n      </div>\n    </div>;\n  }\n\n  private _renderStar(rating: number): JSX.Element {\n    const inputId = `${this._id}-${rating}`;\n\n    return <div className={ css('ms-Rating-star', styles.star, {\n      ['is-selected ' + styles.starIsSelected]: rating <= (this.state.rating as number),\n      ['is-inFocus ' + styles.starIsInFocus]: rating === this.state.focusedRating,\n      ['is-disabled ' + styles.starIsDisabled]: this.props.disabled\n    }) } key={ rating }>\n      <input\n        className={ css('ms-Rating-input', styles.input) }\n        type='radio'\n        name={ this._id }\n        id={ inputId }\n        value={ rating }\n        aria-labelledby={ `${this._labelId}-${rating}` }\n        disabled={ this.props.disabled }\n        checked={ rating === this.state.rating }\n        onChange={ this._onChange.bind(this, rating) }\n        onFocus={ this._onFocus.bind(this, rating) }\n        onBlur={ this._onBlur.bind(this, rating) }\n      />\n      <label className={ css('ms-Rating-label', styles.label) } htmlFor={ inputId }>\n        { this._getLabel(rating) }\n        { this._getIcon() }\n      </label>\n    </div>;\n  }\n\n  private _onFocus(value: number, ev: React.FocusEvent<HTMLElement>): void {\n    this.setState({\n      focusedRating: value\n    } as IRatingState);\n\n    if (this.props.onFocus) {\n      this.props.onFocus(ev);\n    }\n  }\n\n  private _onBlur(option: number, ev: React.FocusEvent<HTMLElement>): void {\n    this.setState({\n      focusedRating: null\n    } as IRatingState);\n\n    if (this.props.onBlur) {\n      this.props.onBlur(ev);\n    }\n  }\n\n  private _onChange(rating: number, evt: React.FormEvent<HTMLInputElement>) {\n    this.setState({\n      rating: rating\n    } as IRatingState);\n\n    const { onChanged } = this.props;\n    if (onChanged) {\n      onChanged(rating);\n    }\n  }\n\n  private _getLabel(rating: number): JSX.Element {\n    const text = this.props.ariaLabelIcon || 'Star';\n\n    return (\n      <span\n        id={ `${this._labelId}-${rating}` }\n        className={ css('ms-Rating-labelText', styles.labelText) }\n      >\n        { `${rating} ${text}` }\n      </span>\n    );\n  }\n\n  private _getIcon(): JSX.Element {\n    return <Icon iconName={ this.props.icon || 'favoriteStarFill' } />;\n  }\n\n  private _getInitialValue(props: IRatingProps) {\n    if (typeof props.rating === 'undefined') {\n      return props.min;\n    }\n\n    if (props.rating === null) {\n      return null;\n    }\n\n    return this._getClampedRating(props.rating);\n  }\n\n  private _getClampedRating(rating: number): number {\n    rating = Math.floor(rating);\n\n    return Math.min(Math.max(rating, this.props.min as number), this.props.max as number);\n  }\n}"]}