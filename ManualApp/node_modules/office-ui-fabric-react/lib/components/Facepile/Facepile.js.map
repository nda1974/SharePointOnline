{"version":3,"file":"Facepile.js","sourceRoot":"../src/","sources":["components/Facepile/Facepile.tsx"],"names":[],"mappings":"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","sourcesContent":["import * as React from 'react';\nimport {\n  BaseComponent,\n  buttonProperties,\n  css,\n  divProperties,\n  getId,\n  getNativeProps\n} from '../../Utilities';\nimport {\n  IFacepileProps,\n  IFacepilePersona,\n  OverflowButtonType\n} from './Facepile.Props';\nimport {\n  FocusZone,\n  FocusZoneDirection\n} from '../../FocusZone';\nimport {\n  BaseButton\n} from '../../Button';\nimport {\n  Icon\n} from '../../Icon';\nimport {\n  Persona,\n  PersonaSize\n} from '../../Persona';\nimport * as stylesImport from './Facepile.scss';\nconst styles: any = stylesImport;\n\nexport class Facepile extends BaseComponent<IFacepileProps, {}> {\n  public static defaultProps: IFacepileProps = {\n    maxDisplayablePersonas: 5,\n    personas: [],\n    personaSize: PersonaSize.extraSmall\n  };\n\n  private _ariaDescriptionId: string;\n\n  constructor(props: IFacepileProps) {\n    super(props);\n\n    this._ariaDescriptionId = getId();\n\n  }\n  public render(): JSX.Element {\n    let {\n      chevronButtonProps,\n      maxDisplayablePersonas,\n      overflowButtonProps,\n      overflowButtonType,\n      ariaDescription,\n      className,\n      personas,\n      showAddButton\n    } = this.props;\n    let numPersonasToShow: number = Math.min(personas.length, maxDisplayablePersonas as number);\n\n    // Added for deprecating chevronButtonProps.  Can remove after v1.0\n    if (chevronButtonProps && !overflowButtonProps) {\n      overflowButtonProps = chevronButtonProps;\n      overflowButtonType = OverflowButtonType.downArrow;\n    }\n\n    return (\n      <div className={ css('ms-Facepile', styles.root, className) }>\n        <div\n          className={ css('ms-Facepile-itemContainer', styles.itemContainer) }\n        >\n          { showAddButton ? this._getAddNewElement() : null }\n          { this.onRenderAriaDescription() }\n          <FocusZone\n            ariaDescribedBy={ this._ariaDescriptionId }\n            role='listbox'\n            className={ css('ms-Facepile-members', styles.members) }\n            direction={ FocusZoneDirection.horizontal }\n          >\n            {\n              personas.slice(0, numPersonasToShow).map((persona: IFacepilePersona, index: number) => {\n                const personaControl: JSX.Element = this._getPersonaControl(persona);\n                return persona.onClick ?\n                  this._getElementWithOnClickEvent(personaControl, persona, index) :\n                  this._getElementWithoutOnClickEvent(personaControl, persona, index);\n              })\n            }\n          </FocusZone>\n          { overflowButtonProps ? this._getOverflowElement(numPersonasToShow) : null }\n        </div>\n      </div>\n    );\n  }\n\n  protected onRenderAriaDescription() {\n    const { ariaDescription } = this.props;\n\n    // If ariaDescription is given, descriptionId will be assigned to ariaDescriptionSpan,\n    // otherwise it will be assigned to descriptionSpan.\n    return ariaDescription && (\n      <span className={ styles.screenReaderOnly } id={ this._ariaDescriptionId }>{ ariaDescription }</span>\n    );\n  }\n\n  private _getPersonaControl(persona: IFacepilePersona): JSX.Element {\n    let { getPersonaProps, personaSize } = this.props;\n    return <Persona\n      imageInitials={ persona.imageInitials }\n      imageUrl={ persona.imageUrl }\n      initialsColor={ persona.initialsColor }\n      primaryText={ persona.personaName }\n      size={ personaSize }\n      hidePersonaDetails={ true }\n      {...(getPersonaProps ? getPersonaProps(persona) : null) }\n    />;\n  }\n\n  private _getElementWithOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\n    return <BaseButton\n      { ...getNativeProps(persona, buttonProperties) }\n      key={ (!!persona.imageUrl ? 'i' : '') + index }\n      data-is-focusable={ true }\n      role='option'\n      className={ css('ms-Facepile-itemButton ms-Facepile-person', styles.itemButton) }\n      title={ persona.personaName }\n      onClick={ this._onPersonaClick.bind(this, persona) }\n      onMouseMove={ this._onPersonaMouseMove.bind(this, persona) }\n      onMouseOut={ this._onPersonaMouseOut.bind(this, persona) }\n    >\n      { personaControl }\n    </BaseButton>;\n  }\n\n  private _getElementWithoutOnClickEvent(personaControl: JSX.Element, persona: IFacepilePersona, index: number): JSX.Element {\n    return <div\n      { ...getNativeProps(persona, divProperties) }\n      key={ (!!persona.imageUrl ? 'i' : '') + index }\n      data-is-focusable={ true }\n      role='option'\n      className={ css('ms-Facepile-itemButton ms-Facepile-person', styles.itemButton) }\n      title={ persona.personaName }\n      onMouseMove={ this._onPersonaMouseMove.bind(this, persona) }\n      onMouseOut={ this._onPersonaMouseOut.bind(this, persona) }\n    >\n      { personaControl }\n    </div>;\n  }\n\n  private _getOverflowElement(numPersonasToShow: number): JSX.Element | null {\n    switch (this.props.overflowButtonType) {\n      case OverflowButtonType.descriptive:\n        return this._getDescriptiveOverflowElement(numPersonasToShow);\n      case OverflowButtonType.downArrow:\n        return this._getIconElement('ChevronDown');\n      case OverflowButtonType.more:\n        return this._getIconElement('More');\n      default:\n        return null;\n    }\n  }\n\n  private _getDescriptiveOverflowElement(numPersonasToShow: number): JSX.Element | null {\n    let { overflowButtonProps, personas, personaSize } = this.props;\n    let numPersonasNotPictured: number = personas.length - numPersonasToShow;\n\n    if (!overflowButtonProps || numPersonasNotPictured < 1) { return null; }\n\n    let personaNames: string = personas.slice(numPersonasToShow).map((p: IFacepilePersona) => p.personaName).join(', ');\n\n    return <BaseButton\n      { ...overflowButtonProps}\n      ariaDescription={ personaNames }\n      className={ css('ms-Facepile-descriptiveOverflowButton', 'ms-Facepile-itemButton', styles.descriptiveOverflowButton, styles.itemButton) }\n    >\n      <Persona\n        title={ personaNames }\n        size={ personaSize }\n        hidePersonaDetails={ true }\n        onRenderInitials={ () => {\n          return (\n            <span>{ '+' + numPersonasNotPictured }</span>\n          );\n        } }\n      />\n    </BaseButton>;\n  }\n\n  private _getIconElement(icon: string): JSX.Element {\n    let { overflowButtonProps, personaSize } = this.props;\n\n    return <BaseButton\n      {...overflowButtonProps}\n      className={ css('ms-Facepile-overflowButton', 'ms-Facepile-itemButton', styles.overflowButton, styles.itemButton) }\n    >\n      <Persona\n        size={ personaSize }\n        hidePersonaDetails={ true }\n        onRenderInitials={ () => (\n          <Icon iconName={ icon } />\n        ) }\n      />\n    </BaseButton>;\n  }\n\n  private _getAddNewElement(): JSX.Element {\n    let { addButtonProps, personaSize } = this.props;\n    return <BaseButton\n      {...addButtonProps}\n      className={ css('ms-Facepile-addButton', 'ms-Facepile-itemButton', styles.itemButton, styles.addButton) }\n    >\n      <Persona\n        size={ personaSize }\n        hidePersonaDetails={ true }\n        onRenderInitials={ () => (\n          <Icon iconName='AddFriend' />\n        ) }\n      />\n    </BaseButton>;\n  }\n\n  private _onPersonaClick(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\n    persona.onClick!(ev, persona);\n    ev!.preventDefault();\n    ev!.stopPropagation();\n  }\n\n  private _onPersonaMouseMove(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\n    if (!!persona.onMouseMove) {\n      persona.onMouseMove(ev, persona);\n    }\n  }\n\n  private _onPersonaMouseOut(persona: IFacepilePersona, ev?: React.MouseEvent<HTMLElement>): void {\n    if (!!persona.onMouseOut) {\n      persona.onMouseOut(ev, persona);\n    }\n  }\n}\n"]}